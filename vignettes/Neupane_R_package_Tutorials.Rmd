---
title: "Neupane R package"
author: "Anisha Neupane"
date: "12/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

sim.fbd Functions:

FossilSim can be used to simulate trees directly from a fossilized-birth death process using the sim.fbd family of functions, whose interface is similar to the sim.bd functions in TreeSim. These functions return a list of SAtree objects, since the simulated trees may contain sampled ancestors represented as tips with zero-length branches.

## Installation

You might need to install tidyverse and ggplot2.

```{r}
install.packages("tidyverse")
install.packages("ggplot2")
```

Load in the libraries used by this package.

``` {r}
library(ggplot2)
library(tidyverse)
```

You might need to install some fbd packages for this package to run.

```{r}
install.packages("FossilSim")
```

Load the package we just downloaded.

```{r}
library(FossilSim)
```

Now, we install my R package.

```{r}
devtools::install_github("Anisha-Neupane/R_package_Neupane")
library(NeupaneRpackage)

```

Now, we load my R package using devtools. load_all loads a package. It roughly simulates what happens when a package is installed and loaded with library().

```{r}
devtools::load_all()
```

Let us download some data for our package:
```{r}

download.file(url = "https://raw.githubusercontent.com/Anisha-Neupane/R_package_Neupane/master/Data/ants_timevary.log", destfile = "/cloud/project/vignettes/Ants_timevary.log")

```

Load the data using read_tsv. 
```{r}
all <- read_tsv("/cloud/project/vignettes/Ants_timevary.log")  #read_tsv is used for tab separated ("\") values.
all
```

Rename speciation_rate, extinction_rate and psi:
```{r}
lambda <- all$speciation_rate
mu <- all$extinction_rate
psi <- all$psi

```

Now lets simulate the data:
```{r}
i = 1
trees <- vector()
while (i <=20) { 
trees[i] <- c(NeupaneRpackage::Simulation(n = 10, numbsim = 1, lambda[i], mu[i], psi[i], frac = .01))
print(trees[i])
i <- i + 1
}
```

Lets collect the simulated data:
```{r}
i = 1  
simulated_data <- vector()
for (i in 1:20) { 
simulated_data[i] <- c(trees[[i]]$root.edge)
}
emperical_data <- all$origin_time
meane <- mean(emperical_data)
means <- mean(simulated_data)

```

Data visualization using function treeplot:
```{r}
i = 1
for (i in 1:20) {
treeplot(i)
} 

```

output of visualization:
```{r}
treeplot(1)
```

Compare the simulated data with emperical data:

Create a dataframe to store all your data:
```{r}
datas <- data.frame(simulated_data, emperical_data, meane, means)

```

Now using the function comparison:
```{r}
comparision(datasdf = datas)
```

Including plots:
```{r datas, echo = FALSE}
comparision(datasdf = datas)
```

Calculating the effect size:
```{r}
Effect_size(datasdf = datas)
```
## Working Example
+An example of each function that works.
+Say something about why this is a good thing to do.
+something about expected output.


