<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neupane R package • NeupaneRpackage</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Neupane R package">
<meta property="og:description" content="NeupaneRpackage">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NeupaneRpackage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Neupane_R_package_Tutorials.html">Neupane R package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Neupane R package</h1>
                        <h4 data-toc-skip class="author">Anisha Neupane</h4>
            
            <h4 data-toc-skip class="date">12/2/2021</h4>
      
      
      <div class="hidden name"><code>Neupane_R_package_Tutorials.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="data-simulation">Data Simulation<a class="anchor" aria-label="anchor" href="#data-simulation"></a>
</h2>
<p>This tutorial uses the function from package FossilSim to simulate datasets from posterior distribution. We quantify some characteristics of both the simulated and emperical(origin time) datasets using test statistics, here, mean and standard deviation. The goal is to check the model accuracy.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You might need to install and load these packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Installing package into '/tmp/Rtmp7sXJdu/temp_libpath119899070'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Installing package into '/tmp/Rtmp7sXJdu/temp_libpath119899070'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.1 ──</span></code></pre>
<pre><code><span class="co">## <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">ggplot2</span> 3.3.5     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">purrr  </span> 0.3.4</span>
<span class="co">## <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">tibble </span> 3.1.6     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">dplyr  </span> 1.0.7</span>
<span class="co">## <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">tidyr  </span> 1.1.4     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">stringr</span> 1.4.0</span>
<span class="co">## <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">readr  </span> 2.0.2     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span></code></pre>
<pre><code><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">## <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span>
<span class="co">## <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Installing package into '/tmp/Rtmp7sXJdu/temp_libpath119899070'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Loading required package: usethis</span></code></pre>
<p>You need to install FossilSim R package for this package to run. # FossilSim is used for simulating trees directly from a fossilized-birth death process using the sim.fbd function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"FossilSim"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Installing package into '/tmp/Rtmp7sXJdu/temp_libpath119899070'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FossilSim</span><span class="op">)</span></code></pre></div>
<p>Now, we install my R package.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Anisha-Neupane/R_package_Neupane"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Using github PAT from envvar GITHUB_PAT</span></code></pre>
<pre><code><span class="co">## Downloading GitHub repo Anisha-Neupane/R_package_Neupane@HEAD</span></code></pre>
<pre><code>##   
   checking for file ‘/tmp/Rtmpfy3711/remotes63e2512ec2d/Anisha-Neupane-R_package_Neupane-ad73055/DESCRIPTION’ ...
  
 [32m✓ [39m   [38;5;247mchecking for file ‘/tmp/Rtmpfy3711/remotes63e2512ec2d/Anisha-Neupane-R_package_Neupane-ad73055/DESCRIPTION’ [39m [36m [39m
## 
  
 [38;5;247m─ [39m [38;5;247m   [39m [38;5;247mpreparing ‘NeupaneRpackage’: [39m [36m [39m
## 
  
   checking DESCRIPTION meta-information ...
  
 [32m✓ [39m   [38;5;247mchecking DESCRIPTION meta-information [39m [36m [39m
## 
  
 [38;5;247m─ [39m [38;5;247m   [39m [38;5;247mchecking for LF line-endings in source and make files and shell scripts [39m [36m [39m
## 
  
 [38;5;247m─ [39m [38;5;247m   [39m [38;5;247mchecking for empty or unneeded directories [39m [36m [39m
## 
  
 [38;5;247m─ [39m [38;5;247m   [39m [38;5;247mbuilding ‘NeupaneRpackage_0.0.0.9000.tar.gz’ [39m [36m [39m
## 
  
   
## </code></pre>
<pre><code><span class="co">## Installing package into '/tmp/Rtmp7sXJdu/temp_libpath119899070'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">NeupaneRpackage</span><span class="op">)</span></code></pre></div>
<p>Now, we load my R package using devtools. load_all() loads a package. It roughly simulates what happens when a package is installed and loaded with library().</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading <span style="color: #0000BB;">NeupaneRpackage</span></span></code></pre>
<p>Let us download some data for our package:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/Anisha-Neupane/R_package_Neupane/master/Data/ants_timevary.log"</span>, destfile <span class="op">=</span> <span class="st">"/cloud/project/vignettes/Ants_timevary.log"</span><span class="op">)</span></code></pre></div>
<p>Load the data using read_tsv.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="st">"/cloud/project/vignettes/Ants_timevary.log"</span><span class="op">)</span>  <span class="co">#read_tsv is used for tab separated ("\") values.</span></code></pre></div>
<pre><code><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">20</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">1557</span></span></code></pre>
<pre><code><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">## <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">## <span style="color: #00BB00;">dbl</span> (1557): Iteration, Posterior, Likelihood, Prior, alpha_cytb[1], alpha_cy...</span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">## <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 20 × 1,557</span></span>
<span class="co">##    Iteration Posterior Likelihood  Prior `alpha_cytb[1]` `alpha_cytb[2]`</span>
<span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span>         0  -<span style="color: #BB0000; text-decoration: underline;">869</span><span style="color: #BB0000;">910.</span>   -<span style="color: #BB0000; text-decoration: underline;">866</span><span style="color: #BB0000;">709.</span> -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">200.</span>           0.792           0.256</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span>        10  -<span style="color: #BB0000; text-decoration: underline;">665</span><span style="color: #BB0000;">628.</span>   -<span style="color: #BB0000; text-decoration: underline;">662</span><span style="color: #BB0000;">948.</span> -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">679.</span>           0.238           0.245</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span>        20  -<span style="color: #BB0000; text-decoration: underline;">645</span><span style="color: #BB0000;">766.</span>   -<span style="color: #BB0000; text-decoration: underline;">644</span><span style="color: #BB0000;">125</span>  -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">640.</span>           0.152           0.270</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span>        30  -<span style="color: #BB0000; text-decoration: underline;">641</span><span style="color: #BB0000;">394.</span>   -<span style="color: #BB0000; text-decoration: underline;">640</span><span style="color: #BB0000;">495.</span>  -<span style="color: #BB0000;">899.</span>           0.154           0.269</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span>        40  -<span style="color: #BB0000; text-decoration: underline;">639</span><span style="color: #BB0000;">094.</span>   -<span style="color: #BB0000; text-decoration: underline;">638</span><span style="color: #BB0000;">700.</span>  -<span style="color: #BB0000;">394.</span>           0.159           0.279</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span>        50  -<span style="color: #BB0000; text-decoration: underline;">638</span><span style="color: #BB0000;">528.</span>   -<span style="color: #BB0000; text-decoration: underline;">638</span><span style="color: #BB0000;">129.</span>  -<span style="color: #BB0000;">399.</span>           0.149           0.276</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span>        60  -<span style="color: #BB0000; text-decoration: underline;">638</span><span style="color: #BB0000;">197.</span>   -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">788.</span>  -<span style="color: #BB0000;">409.</span>           0.158           0.275</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span>        70  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">743.</span>   -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">260.</span>  -<span style="color: #BB0000;">483.</span>           0.151           0.281</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span>        80  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">465.</span>   -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">026</span>   -<span style="color: #BB0000;">439.</span>           0.148           0.276</span>
<span class="co">## <span style="color: #BCBCBC;">10</span>        90  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">443.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">947.</span>  -<span style="color: #BB0000;">496.</span>           0.154           0.280</span>
<span class="co">## <span style="color: #BCBCBC;">11</span>       100  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">373.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">928.</span>  -<span style="color: #BB0000;">445.</span>           0.152           0.278</span>
<span class="co">## <span style="color: #BCBCBC;">12</span>       110  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">419.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">925.</span>  -<span style="color: #BB0000;">494.</span>           0.150           0.273</span>
<span class="co">## <span style="color: #BCBCBC;">13</span>       120  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">350.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">879.</span>  -<span style="color: #BB0000;">471.</span>           0.151           0.268</span>
<span class="co">## <span style="color: #BCBCBC;">14</span>       130  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">351.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">859.</span>  -<span style="color: #BB0000;">493.</span>           0.152           0.277</span>
<span class="co">## <span style="color: #BCBCBC;">15</span>       140  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">294.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">851.</span>  -<span style="color: #BB0000;">443.</span>           0.150           0.282</span>
<span class="co">## <span style="color: #BCBCBC;">16</span>       150  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">245.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">841.</span>  -<span style="color: #BB0000;">404.</span>           0.149           0.282</span>
<span class="co">## <span style="color: #BCBCBC;">17</span>       160  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">267.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">829.</span>  -<span style="color: #BB0000;">437.</span>           0.153           0.273</span>
<span class="co">## <span style="color: #BCBCBC;">18</span>       170  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">314.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">824.</span>  -<span style="color: #BB0000;">490.</span>           0.148           0.269</span>
<span class="co">## <span style="color: #BCBCBC;">19</span>       180  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">325.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">824.</span>  -<span style="color: #BB0000;">501.</span>           0.151           0.287</span>
<span class="co">## <span style="color: #BCBCBC;">20</span>       190  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">318.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">811.</span>  -<span style="color: #BB0000;">507.</span>           0.151           0.273</span>
<span class="co">## <span style="color: #949494;"># … with 1,551 more variables: alpha_cytb[3] &lt;dbl&gt;, alpha_cytb[4] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   alpha_cytb[5] &lt;dbl&gt;, alpha_cytb[6] &lt;dbl&gt;, alpha_cytb[7] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   alpha_cytb[8] &lt;dbl&gt;, alpha_cytb[9] &lt;dbl&gt;, branch_rates[1] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   branch_rates[2] &lt;dbl&gt;, branch_rates[3] &lt;dbl&gt;, branch_rates[4] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   branch_rates[5] &lt;dbl&gt;, branch_rates[6] &lt;dbl&gt;, branch_rates[7] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   branch_rates[8] &lt;dbl&gt;, branch_rates[9] &lt;dbl&gt;, branch_rates[10] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   branch_rates[11] &lt;dbl&gt;, branch_rates[12] &lt;dbl&gt;, branch_rates[13] &lt;dbl&gt;, …</span></span></code></pre>
<p>Rename speciation_rate, extinction_rate and psi:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">all</span><span class="op">$</span><span class="va">speciation_rate</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">all</span><span class="op">$</span><span class="va">extinction_rate</span>
<span class="va">psi</span> <span class="op">&lt;-</span> <span class="va">all</span><span class="op">$</span><span class="va">psi</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="function-simulation">Function: Simulation<a class="anchor" aria-label="anchor" href="#function-simulation"></a>
</h2>
<p>This function simulates trees while conditioning on the number of sampled extant taxa using sim.fbd.taxa function. It requires the fossil sampling rate parameter psi as an argument.</p>
<p>Now, lets simulate the data using the function simulation:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;=</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span> 
<span class="va">trees</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">NeupaneRpackage</span><span class="fu">::</span><span class="fu"><a href="../reference/Simulation.html">Simulation</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, numbsim <span class="op">=</span> <span class="fl">1</span>, <span class="va">lambda</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">mu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">psi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, frac <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trees</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>
<span class="op">}</span></code></pre></div>
<pre><code><span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 2973 tips and 2972 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t369_1, t47_4, t50_2, t41_3, t341_3, t381_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 1266 tips and 1265 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t167_1, t666_1, t413_3, t899_1, t126_1, t315_4, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 409 tips and 408 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t707_2, t791_1, t590_1, t963_1, t568_1, t673_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 103 tips and 102 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t132_1, t729_1, t794_1, t905_1, t505_2, t84_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 16 tips and 15 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t176_1, t174_1, t671_1, t949_1, t890_1, t611_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t41_1, t436_1, t80_1, t979_1, t66_1, t735_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 13 tips and 12 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t553_1, t822_1, t134_1, t486_1, t788_1, t457_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t500_1, t203_1, t499_1, t804_1, t107_1, t254_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t605_1, t818_1, t36_1, t269_1, t926_1, t873_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 12 tips and 11 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t189_1, t589_1, t378_1, t225_1, t766_1, t739_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 10 tips and 9 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t964_1, t574_1, t60_1, t710_1, t388_1, t375_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t62_1, t822_1, t30_1, t448_1, t668_1, t936_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 12 tips and 11 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t948_1, t920_1, t357_1, t695_1, t481_1, t624_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t521_1, t268_1, t993_1, t832_1, t682_1, t389_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 10 tips and 9 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t315_1, t410_1, t85_1, t229_1, t557_1, t4_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t305_1, t1018_1, t281_1, t147_1, t721_1, t769_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t24_1, t242_1, t743_1, t973_1, t900_1, t336_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 10 tips and 9 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t395_1, t76_1, t57_1, t780_1, t737_1, t243_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t1074_1, t634_1, t647_1, t128_1, t287_1, t990_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 13 tips and 12 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t703_1, t233_1, t843_1, t145_1, t152_1, t934_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span></code></pre>
<p>In the above code we have created a loop using ‘while’ so that we do not need to enter the values manually. Then we have created the variable tree which is a vector to store our data from simulation.</p>
<p>It returns a list of SAtree objects as the simulated trees may contain sampled ancestors as tips with zero-length branches.</p>
<p>We can check the simulated data value using trees[[n]]$root.edge function.</p>
<p>For Example:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">root.edge</span></code></pre></div>
<pre><code><span class="co">## [1] 30.64963</span></code></pre>
<p>It returns the simulated value from first tree simulated. We can do the same for other 19.</p>
<p>If we want to create an object to store the simulated data, we can create a for loop which collects the data at once for all 20 trees.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span>  
<span class="va">simulated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span> 
<span class="va">simulated_data</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">trees</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">root.edge</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We also need to create some variable to put our emperical value which is the origin time from our given dataset, and calculate mean for both.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">emperical_data</span> <span class="op">&lt;-</span> <span class="va">all</span><span class="op">$</span><span class="va">origin_time</span>
<span class="va">meane</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">emperical_data</span><span class="op">)</span>
<span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">simulated_data</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="function-treeplot">Function treeplot<a class="anchor" aria-label="anchor" href="#function-treeplot"></a>
</h2>
<p>This function plots a strati graphic range representation of the tree and fossil samples using rangeplot.asymmetric function. It assumes that all speciation events are asymmetric.</p>
<p>Working example:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/treeplot.html">treeplot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span class="co">## NULL</span></code></pre>
<p>Now, lets create a loop for this function that gives the plot for all the simulated data at once.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span>
<span class="fu"><a href="../reference/treeplot.html">treeplot</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
<span class="op">}</span> </code></pre></div>
<p><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-1.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-2.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-3.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-4.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-5.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-6.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-7.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-8.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-9.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-10.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-11.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-12.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-13.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-14.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-15.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-16.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-17.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-18.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-19.png" width="700"><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-14-20.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="function-comparision">Function comparision<a class="anchor" aria-label="anchor" href="#function-comparision"></a>
</h2>
<p>This function compares the simulated data with the emperical data using emperical mean. It returns the ggplot of simulated data against emperical mean. If the emperical test statistic value is very different from the simulated ones, our model is not doing a good job of replicating some aspect of the process that generated our data.</p>
<p>We can make a dataframe to keep the necessary data for our convenience:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="va">emperical_data</span>, <span class="va">meane</span>, <span class="va">means</span><span class="op">)</span></code></pre></div>
<p>Working example of the function:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/comparision.html">comparision</a></span><span class="op">(</span>datasdf <span class="op">=</span> <span class="va">datas</span><span class="op">)</span></code></pre></div>
<p><img src="Neupane_R_package_Tutorials_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>It returns a curve for the simulated data and a dotted line for emperical mean.</p>
</div>
<div class="section level2">
<h2 id="function-effect_size">Function effect_size<a class="anchor" aria-label="anchor" href="#function-effect_size"></a>
</h2>
<p>This function calculate the difference between the emperical test statistic value and the median of simulated test statistic divided by the standard deviation of simulated test statistic. It shows how many standard deviations away from the median is the observed value.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/Effect_size.html">Effect_size</a></span><span class="op">(</span>datasdf <span class="op">=</span> <span class="va">datas</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.9424391</span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anisha Neupane.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.0.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
